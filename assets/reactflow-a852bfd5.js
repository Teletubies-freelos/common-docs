import{r as m,g as Fo}from"./react-67fe9742.js";import{z as Yo,s as mn,i as He,p as Zo,d as Wo}from"./mermaid-120b84ec.js";var xn={exports:{}},lt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xo=m,Ko=Symbol.for("react.element"),Uo=Symbol.for("react.fragment"),Go=Object.prototype.hasOwnProperty,qo=Xo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qo={key:!0,ref:!0,__self:!0,__source:!0};function Sn(e,t,n){var o,s={},i=null,r=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(r=t.ref);for(o in t)Go.call(t,o)&&!Qo.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)s[o]===void 0&&(s[o]=t[o]);return{$$typeof:Ko,type:e,key:i,ref:r,props:s,_owner:qo.current}}lt.Fragment=Uo;lt.jsx=Sn;lt.jsxs=Sn;xn.exports=lt;var E=xn.exports;function le(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=le(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var bn={exports:{}},wn={},En={exports:{}},Nn={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ve=m;function Jo(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var es=typeof Object.is=="function"?Object.is:Jo,ts=Ve.useState,ns=Ve.useEffect,os=Ve.useLayoutEffect,ss=Ve.useDebugValue;function rs(e,t){var n=t(),o=ts({inst:{value:n,getSnapshot:t}}),s=o[0].inst,i=o[1];return os(function(){s.value=n,s.getSnapshot=t,mt(s)&&i({inst:s})},[e,n,t]),ns(function(){return mt(s)&&i({inst:s}),e(function(){mt(s)&&i({inst:s})})},[e]),ss(n),n}function mt(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!es(e,n)}catch{return!0}}function is(e,t){return t()}var cs=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?is:rs;Nn.useSyncExternalStore=Ve.useSyncExternalStore!==void 0?Ve.useSyncExternalStore:cs;En.exports=Nn;var as=En.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ut=m,ls=as;function us(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ds=typeof Object.is=="function"?Object.is:us,fs=ls.useSyncExternalStore,gs=ut.useRef,hs=ut.useEffect,ps=ut.useMemo,ys=ut.useDebugValue;wn.useSyncExternalStoreWithSelector=function(e,t,n,o,s){var i=gs(null);if(i.current===null){var r={hasValue:!1,value:null};i.current=r}else r=i.current;i=ps(function(){function l(f){if(!u){if(u=!0,a=f,f=o(f),s!==void 0&&r.hasValue){var p=r.value;if(s(p,f))return d=p}return d=f}if(p=d,ds(a,f))return p;var g=o(f);return s!==void 0&&s(p,g)?p:(a=f,d=g)}var u=!1,a,d,h=n===void 0?null:n;return[function(){return l(t())},h===null?void 0:function(){return l(h())}]},[t,n,o,s]);var c=fs(e,i[0],i[1]);return hs(function(){r.hasValue=!0,r.value=c},[c]),ys(c),c};bn.exports=wn;var ms=bn.exports;const xs=Fo(ms),Zt=e=>{let t;const n=new Set,o=(l,u)=>{const a=typeof l=="function"?l(t):l;if(!Object.is(a,t)){const d=t;t=u??typeof a!="object"?a:Object.assign({},t,a),n.forEach(h=>h(t,d))}},s=()=>t,c={setState:o,getState:s,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{n.clear()}};return t=e(o,s,c),c},Ss=e=>e?Zt(e):Zt,{useSyncExternalStoreWithSelector:bs}=xs;function Cn(e,t=e.getState,n){const o=bs(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return m.useDebugValue(o),o}const Wt=(e,t)=>{const n=Ss(e),o=(s,i=t)=>Cn(n,s,i);return Object.assign(o,n),o},ws=(e,t)=>e?Wt(e,t):Wt;function ie(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let o=0;o<n.length;o++)if(!Object.prototype.hasOwnProperty.call(t,n[o])||!Object.is(e[n[o]],t[n[o]]))return!1;return!0}const dt=m.createContext(null),Es=dt.Provider,fe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Mn=fe.error001();function G(e,t){const n=m.useContext(dt);if(n===null)throw new Error(Mn);return Cn(n,e,t)}const ne=()=>{const e=m.useContext(dt);if(e===null)throw new Error(Mn);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Ns=e=>e.userSelectionActive?"none":"all";function Cs({position:e,children:t,className:n,style:o,...s}){const i=G(Ns),r=`${e}`.split("-");return E.jsx("div",{className:le(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s,children:t})}function Ms({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:E.jsx(Cs,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:E.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const vs=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:c=2,children:l,className:u,...a})=>{const d=m.useRef(null),[h,f]=m.useState({x:0,y:0,width:0,height:0}),p=le(["react-flow__edge-textwrapper",u]);return m.useEffect(()=>{if(d.current){const g=d.current.getBBox();f({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:E.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:p,visibility:h.width?"visible":"hidden",...a,children:[s&&E.jsx("rect",{width:h.width+2*r[0],x:-r[0],y:-r[1],height:h.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),E.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:d,style:o,children:n}),l]})};var As=m.memo(vs);const _t=e=>({width:e.offsetWidth,height:e.offsetHeight}),Fe=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),kt=(e={x:0,y:0},t)=>({x:Fe(e.x,t[0][0],t[1][0]),y:Fe(e.y,t[0][1],t[1][1])}),Xt=(e,t,n)=>e<t?Fe(Math.abs(e-t),1,50)/50:e>n?-Fe(Math.abs(e-n),1,50)/50:0,vn=(e,t)=>{const n=Xt(e.x,35,t.width-35)*20,o=Xt(e.y,35,t.height-35)*20;return[n,o]},An=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},$s=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Dt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),Ps=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Kt=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Nt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},_s=e=>ae(e.width)&&ae(e.height)&&ae(e.x)&&ae(e.y),ae=e=>!isNaN(e)&&isFinite(e),J=Symbol.for("internals"),$n=["Enter"," ","Escape"],ks=(e,t)=>{},Ds=e=>"nativeEvent"in e;function Ct(e){var s,i;const t=Ds(e)?e.nativeEvent:e,n=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const Pn=e=>"clientX"in e,Se=(e,t)=>{var i,r;const n=Pn(e),o=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(r=e.touches)==null?void 0:r[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},rt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Je=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:h,interactionWidth:f=20})=>E.jsxs(E.Fragment,{children:[E.jsx("path",{id:e,style:a,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:h}),f&&E.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),s&&ae(n)&&ae(o)?E.jsx(As,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u}):null]});Je.displayName="BaseEdge";function Ke(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function _n({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,c=o<t?o+r:o-r;return[i,c,s,r]}function kn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:c}){const l=e*.125+s*.375+r*.375+n*.125,u=t*.125+i*.375+c*.375+o*.125,a=Math.abs(l-e),d=Math.abs(u-t);return[l,u,a,d]}var _e;(function(e){e.Strict="strict",e.Loose="loose"})(_e||(_e={}));var Pe;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Pe||(Pe={}));var qe;(function(e){e.Partial="partial",e.Full="full"})(qe||(qe={}));var xe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(xe||(xe={}));var it;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(it||(it={}));var z;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(z||(z={}));function Ut({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===z.Left||e===z.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Dn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top}){const[r,c]=Ut({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,u]=Ut({pos:i,x1:o,y1:s,x2:e,y2:t}),[a,d,h,f]=kn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${r},${c} ${l},${u} ${o},${s}`,a,d,h,f]}const Rt=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:p,interactionWidth:g})=>{const[x,S,w]=Dn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return E.jsx(Je,{path:x,labelX:S,labelY:w,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:p,interactionWidth:g})});Rt.displayName="SimpleBezierEdge";const Gt={[z.Left]:{x:-1,y:0},[z.Right]:{x:1,y:0},[z.Top]:{x:0,y:-1},[z.Bottom]:{x:0,y:1}},Rs=({source:e,sourcePosition:t=z.Bottom,target:n})=>t===z.Left||t===z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},qt=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Ts({source:e,sourcePosition:t=z.Bottom,target:n,targetPosition:o=z.Top,center:s,offset:i}){const r=Gt[t],c=Gt[o],l={x:e.x+r.x*i,y:e.y+r.y*i},u={x:n.x+c.x*i,y:n.y+c.y*i},a=Rs({source:l,sourcePosition:t,target:u}),d=a.x!==0?"x":"y",h=a[d];let f=[],p,g;const x={x:0,y:0},S={x:0,y:0},[w,N,v,$]=_n({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[d]*c[d]===-1){p=s.x||w,g=s.y||N;const P=[{x:p,y:l.y},{x:p,y:u.y}],T=[{x:l.x,y:g},{x:u.x,y:g}];r[d]===h?f=d==="x"?P:T:f=d==="x"?T:P}else{const P=[{x:l.x,y:u.y}],T=[{x:u.x,y:l.y}];if(d==="x"?f=r.x===h?T:P:f=r.y===h?P:T,t===o){const b=Math.abs(e[d]-n[d]);if(b<=i){const k=Math.min(i-1,i-b);r[d]===h?x[d]=(l[d]>e[d]?-1:1)*k:S[d]=(u[d]>n[d]?-1:1)*k}}if(t!==o){const b=d==="x"?"y":"x",k=r[d]===c[b],R=l[b]>u[b],O=l[b]<u[b];(r[d]===1&&(!k&&R||k&&O)||r[d]!==1&&(!k&&O||k&&R))&&(f=d==="x"?P:T)}const D={x:l.x+x.x,y:l.y+x.y},H={x:u.x+S.x,y:u.y+S.y},A=Math.max(Math.abs(D.x-f[0].x),Math.abs(H.x-f[0].x)),_=Math.max(Math.abs(D.y-f[0].y),Math.abs(H.y-f[0].y));A>=_?(p=(D.x+H.x)/2,g=f[0].y):(p=f[0].x,g=(D.y+H.y)/2)}return[[e,{x:l.x+x.x,y:l.y+x.y},...f,{x:u.x+S.x,y:u.y+S.y},n],p,g,v,$]}function Is(e,t,n,o){const s=Math.min(qt(e,t)/2,qt(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const u=e.x<n.x?-1:1,a=e.y<n.y?1:-1;return`L ${i+s*u},${r}Q ${i},${r} ${i},${r+s*a}`}const c=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${r+s*l}Q ${i},${r} ${i+s*c},${r}`}function Mt({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,borderRadius:r=5,centerX:c,centerY:l,offset:u=20}){const[a,d,h,f,p]=Ts({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:c,y:l},offset:u});return[a.reduce((x,S,w)=>{let N="";return w>0&&w<a.length-1?N=Is(a[w-1],S,a[w+1],r):N=`${w===0?"M":"L"}${S.x} ${S.y}`,x+=N,x},""),d,h,f,p]}const ft=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,sourcePosition:d=z.Bottom,targetPosition:h=z.Top,markerEnd:f,markerStart:p,pathOptions:g,interactionWidth:x})=>{const[S,w,N]=Mt({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:o,targetPosition:h,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return E.jsx(Je,{path:S,labelX:w,labelY:N,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:f,markerStart:p,interactionWidth:x})});ft.displayName="SmoothStepEdge";const Tt=m.memo(e=>{var t;return E.jsx(ft,{...e,pathOptions:m.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Tt.displayName="StepEdge";function zs({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,c]=_n({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,c]}const It=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:h,interactionWidth:f})=>{const[p,g,x]=zs({sourceX:e,sourceY:t,targetX:n,targetY:o});return E.jsx(Je,{path:p,labelX:g,labelY:x,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:h,interactionWidth:f})});It.displayName="StraightEdge";function tt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Qt({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case z.Left:return[t-tt(t-o,i),n];case z.Right:return[t+tt(o-t,i),n];case z.Top:return[t,n-tt(n-s,i)];case z.Bottom:return[t,n+tt(s-n,i)]}}function Rn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,curvature:r=.25}){const[c,l]=Qt({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[u,a]=Qt({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[d,h,f,p]=kn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:l,targetControlX:u,targetControlY:a});return[`M${e},${t} C${c},${l} ${u},${a} ${o},${s}`,d,h,f,p]}const ct=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:p,pathOptions:g,interactionWidth:x})=>{const[S,w,N]=Rn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:g==null?void 0:g.curvature});return E.jsx(Je,{path:S,labelX:w,labelY:N,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:p,interactionWidth:x})});ct.displayName="BezierEdge";const zt=m.createContext(null),Os=zt.Provider;zt.Consumer;const Bs=()=>m.useContext(zt),Hs=e=>"id"in e&&"source"in e&&"target"in e,js=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,vt=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,Ls=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Vs=(e,t)=>{if(!e.source||!e.target)return t;let n;return Hs(e)?n={...e}:n={...e,id:js(e)},Ls(n,t)?t:t.concat(n)},Tn=({x:e,y:t},[n,o,s],i,[r,c])=>{const l={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(l.x/r),y:c*Math.round(l.y/c)}:l},Fs=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),je=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},Ot=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=je(s,t).positionAbsolute;return $s(o,Dt({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ps(n)},In=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,c=[0,0])=>{const l={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(a=>{const{width:d,height:h,selectable:f=!0,hidden:p=!1}=a;if(r&&!f||p)return!1;const{positionAbsolute:g}=je(a,c),x={x:g.x,y:g.y,width:d||0,height:h||0},S=Nt(l,x),w=typeof d>"u"||typeof h>"u"||d===null||h===null,N=i&&S>0,v=(d||0)*(h||0);(w||N||S>=v||a.dragging)&&u.push(a)}),u},zn=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},On=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),c=n/(e.height*(1+i)),l=Math.min(r,c),u=Fe(l,o,s),a=e.x+e.width/2,d=e.y+e.height/2,h=t/2-a*u,f=n/2-d*u;return[h,f,u]},$e=(e,t=0)=>e.transition().duration(t);function Jt(e,t,n,o){return(t[n]||[]).reduce((s,i)=>{var r,c;return`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(((r=e.positionAbsolute)==null?void 0:r.x)??0)+i.x+i.width/2,y:(((c=e.positionAbsolute)==null?void 0:c.y)??0)+i.y+i.height/2}),s},[])}function Ys(e,t,n,o,s,i){const{x:r,y:c}=Se(e),u=t.elementsFromPoint(r,c).find(p=>p.classList.contains("react-flow__handle"));if(u){const p=u.getAttribute("data-nodeid");if(p){const g=Bt(void 0,u),x=u.getAttribute("data-handleid"),S=i({nodeId:p,id:x,type:g});if(S)return{handle:{id:x,type:g,nodeId:p,x:n.x,y:n.y},validHandleResult:S}}}let a=[],d=1/0;if(s.forEach(p=>{const g=Math.sqrt((p.x-n.x)**2+(p.y-n.y)**2);if(g<=o){const x=i(p);g<=d&&(g<d?a=[{handle:p,validHandleResult:x}]:g===d&&a.push({handle:p,validHandleResult:x}),d=g)}}),!a.length)return{handle:null,validHandleResult:Bn()};if(a.length===1)return a[0];const h=a.some(({validHandleResult:p})=>p.isValid),f=a.some(({handle:p})=>p.type==="target");return a.find(({handle:p,validHandleResult:g})=>f?p.type==="target":h?g.isValid:!0)||a[0]}const Zs={source:null,target:null,sourceHandle:null,targetHandle:null},Bn=()=>({handleDomNode:null,isValid:!1,connection:Zs,endHandle:null});function Hn(e,t,n,o,s,i,r){const c=s==="target",l=r.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...Bn(),handleDomNode:l};if(l){const a=Bt(void 0,l),d=l.getAttribute("data-nodeid"),h=l.getAttribute("data-handleid"),f=l.classList.contains("connectable"),p=l.classList.contains("connectableend"),g={source:c?d:n,sourceHandle:c?h:o,target:c?n:d,targetHandle:c?o:h};u.connection=g,f&&p&&(t===_e.Strict?c&&a==="source"||!c&&a==="target":d!==n||h!==o)&&(u.endHandle={nodeId:d,handleId:h,type:a},u.isValid=i(g))}return u}function Ws({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[J]){const{handleBounds:r}=i[J];let c=[],l=[];r&&(c=Jt(i,r,"source",`${t}-${n}-${o}`),l=Jt(i,r,"target",`${t}-${n}-${o}`)),s.push(...c,...l)}return s},[])}function Bt(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function xt(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Xs(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function jn({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:c,edgeUpdaterType:l,onEdgeUpdateEnd:u}){const a=An(e.target),{connectionMode:d,domNode:h,autoPanOnConnect:f,connectionRadius:p,onConnectStart:g,panBy:x,getNodes:S,cancelConnection:w}=i();let N=0,v;const{x:$,y:M}=Se(e),P=a==null?void 0:a.elementFromPoint($,M),T=Bt(l,P),D=h==null?void 0:h.getBoundingClientRect();if(!D||!T)return;let H,A=Se(e,D),_=!1,b=null,k=!1,R=null;const O=Ws({nodes:S(),nodeId:n,handleId:t,handleType:T}),j=()=>{if(!f)return;const[C,I]=vn(A,D);x({x:C,y:I}),N=requestAnimationFrame(j)};r({connectionPosition:A,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:T,connectionStartHandle:{nodeId:n,handleId:t,type:T},connectionEndHandle:null}),g==null||g(e,{nodeId:n,handleId:t,handleType:T});function B(C){const{transform:I}=i();A=Se(C,D);const{handle:V,validHandleResult:F}=Ys(C,a,Tn(A,I,!1,[1,1]),p,O,Z=>Hn(Z,d,n,t,s?"target":"source",c,a));if(v=V,_||(j(),_=!0),R=F.handleDomNode,b=F.connection,k=F.isValid,r({connectionPosition:v&&k?Fs({x:v.x,y:v.y},I):A,connectionStatus:Xs(!!v,k),connectionEndHandle:F.endHandle}),!v&&!k&&!R)return xt(H);b.source!==b.target&&R&&(xt(H),H=R,R.classList.add("connecting","react-flow__handle-connecting"),R.classList.toggle("valid",k),R.classList.toggle("react-flow__handle-valid",k))}function y(C){var I,V;(v||R)&&b&&k&&(o==null||o(b)),(V=(I=i()).onConnectEnd)==null||V.call(I,C),l&&(u==null||u(C)),xt(H),w(),cancelAnimationFrame(N),_=!1,k=!1,b=null,R=null,a.removeEventListener("mousemove",B),a.removeEventListener("mouseup",y),a.removeEventListener("touchmove",B),a.removeEventListener("touchend",y)}a.addEventListener("mousemove",B),a.addEventListener("mouseup",y),a.addEventListener("touchmove",B),a.addEventListener("touchend",y)}const en=()=>!0,Ks=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Us=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.handleId)===t&&(r==null?void 0:r.type)===n}},Ln=m.forwardRef(({type:e="source",position:t=z.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:c,children:l,className:u,onMouseDown:a,onTouchStart:d,...h},f)=>{var D,H;const p=r||null,g=e==="target",x=ne(),S=Bs(),{connectOnClick:w,noPanClassName:N}=G(Ks,ie),{connecting:v,clickConnecting:$}=G(Us(S,p,e),ie);S||(H=(D=x.getState()).onError)==null||H.call(D,"010",fe.error010());const M=A=>{const{defaultEdgeOptions:_,onConnect:b,hasDefaultEdges:k}=x.getState(),R={..._,...A};if(k){const{edges:O,setEdges:j}=x.getState();j(Vs(R,O))}b==null||b(R),c==null||c(R)},P=A=>{if(!S)return;const _=Pn(A);s&&(_&&A.button===0||!_)&&jn({event:A,handleId:p,nodeId:S,onConnect:M,isTarget:g,getState:x.getState,setState:x.setState,isValidConnection:n||x.getState().isValidConnection||en}),_?a==null||a(A):d==null||d(A)},T=A=>{const{onClickConnectStart:_,onClickConnectEnd:b,connectionClickStartHandle:k,connectionMode:R,isValidConnection:O}=x.getState();if(!S||!k&&!s)return;if(!k){_==null||_(A,{nodeId:S,handleId:p,handleType:e}),x.setState({connectionClickStartHandle:{nodeId:S,type:e,handleId:p}});return}const j=An(A.target),B=n||O||en,{connection:y,isValid:C}=Hn({nodeId:S,id:p,type:e},R,k.nodeId,k.handleId||null,k.type,B,j);C&&M(y),b==null||b(A),x.setState({connectionClickStartHandle:null})};return E.jsx("div",{"data-handleid":p,"data-nodeid":S,"data-handlepos":t,"data-id":`${S}-${p}-${e}`,className:le(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,u,{source:!g,target:g,connectable:o,connectablestart:s,connectableend:i,connecting:$,connectionindicator:o&&(s&&!v||i&&v)}]),onMouseDown:P,onTouchStart:P,onClick:w?T:void 0,ref:f,...h,children:l})});Ln.displayName="Handle";var at=m.memo(Ln);const Vn=({data:e,isConnectable:t,targetPosition:n=z.Top,sourcePosition:o=z.Bottom})=>E.jsxs(E.Fragment,{children:[E.jsx(at,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,E.jsx(at,{type:"source",position:o,isConnectable:t})]});Vn.displayName="DefaultNode";var At=m.memo(Vn);const Fn=({data:e,isConnectable:t,sourcePosition:n=z.Bottom})=>E.jsxs(E.Fragment,{children:[e==null?void 0:e.label,E.jsx(at,{type:"source",position:n,isConnectable:t})]});Fn.displayName="InputNode";var Yn=m.memo(Fn);const Zn=({data:e,isConnectable:t,targetPosition:n=z.Top})=>E.jsxs(E.Fragment,{children:[E.jsx(at,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]});Zn.displayName="OutputNode";var Wn=m.memo(Zn);const Ht=()=>null;Ht.displayName="GroupNode";const Gs=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected)}),nt=e=>e.id;function qs(e,t){return ie(e.selectedNodes.map(nt),t.selectedNodes.map(nt))&&ie(e.selectedEdges.map(nt),t.selectedEdges.map(nt))}const Xn=m.memo(({onSelectionChange:e})=>{const t=ne(),{selectedNodes:n,selectedEdges:o}=G(Gs,qs);return m.useEffect(()=>{var i,r;const s={nodes:n,edges:o};e==null||e(s),(r=(i=t.getState()).onSelectionChange)==null||r.call(i,s)},[n,o,e]),null});Xn.displayName="SelectionListener";const Qs=e=>!!e.onSelectionChange;function Js({onSelectionChange:e}){const t=G(Qs);return e||t?E.jsx(Xn,{onSelectionChange:e}):null}const er=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Te(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Y(e,t,n){m.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const tr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:c,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:a,nodesFocusable:d,edgesFocusable:h,edgesUpdatable:f,elevateNodesOnSelect:p,minZoom:g,maxZoom:x,nodeExtent:S,onNodesChange:w,onEdgesChange:N,elementsSelectable:v,connectionMode:$,snapGrid:M,snapToGrid:P,translateExtent:T,connectOnClick:D,defaultEdgeOptions:H,fitView:A,fitViewOptions:_,onNodesDelete:b,onEdgesDelete:k,onNodeDrag:R,onNodeDragStart:O,onNodeDragStop:j,onSelectionDrag:B,onSelectionDragStart:y,onSelectionDragStop:C,noPanClassName:I,nodeOrigin:V,rfId:F,autoPanOnConnect:Z,autoPanOnNodeDrag:W,onError:U,connectionRadius:ee,isValidConnection:Q})=>{const{setNodes:te,setEdges:K,setDefaultNodesAndEdges:re,setMinZoom:ue,setMaxZoom:de,setTranslateExtent:q,setNodeExtent:X,reset:se}=G(er,ie),L=ne();return m.useEffect(()=>{const ge=o==null?void 0:o.map(be=>({...be,...H}));return re(n,ge),()=>{se()}},[]),Y("defaultEdgeOptions",H,L.setState),Y("connectionMode",$,L.setState),Y("onConnect",s,L.setState),Y("onConnectStart",i,L.setState),Y("onConnectEnd",r,L.setState),Y("onClickConnectStart",c,L.setState),Y("onClickConnectEnd",l,L.setState),Y("nodesDraggable",u,L.setState),Y("nodesConnectable",a,L.setState),Y("nodesFocusable",d,L.setState),Y("edgesFocusable",h,L.setState),Y("edgesUpdatable",f,L.setState),Y("elementsSelectable",v,L.setState),Y("elevateNodesOnSelect",p,L.setState),Y("snapToGrid",P,L.setState),Y("snapGrid",M,L.setState),Y("onNodesChange",w,L.setState),Y("onEdgesChange",N,L.setState),Y("connectOnClick",D,L.setState),Y("fitViewOnInit",A,L.setState),Y("fitViewOnInitOptions",_,L.setState),Y("onNodesDelete",b,L.setState),Y("onEdgesDelete",k,L.setState),Y("onNodeDrag",R,L.setState),Y("onNodeDragStart",O,L.setState),Y("onNodeDragStop",j,L.setState),Y("onSelectionDrag",B,L.setState),Y("onSelectionDragStart",y,L.setState),Y("onSelectionDragStop",C,L.setState),Y("noPanClassName",I,L.setState),Y("nodeOrigin",V,L.setState),Y("rfId",F,L.setState),Y("autoPanOnConnect",Z,L.setState),Y("autoPanOnNodeDrag",W,L.setState),Y("onError",U,L.setState),Y("connectionRadius",ee,L.setState),Y("isValidConnection",Q,L.setState),Te(e,te),Te(t,K),Te(g,ue),Te(x,de),Te(T,q),Te(S,X),null},tn={display:"none"},nr={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Kn="react-flow__node-desc",Un="react-flow__edge-desc",or="react-flow__aria-live",sr=e=>e.ariaLiveMessage;function rr({rfId:e}){const t=G(sr);return E.jsx("div",{id:`${or}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:nr,children:t})}function ir({rfId:e,disableKeyboardA11y:t}){return E.jsxs(E.Fragment,{children:[E.jsxs("div",{id:`${Kn}-${e}`,style:tn,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),E.jsx("div",{id:`${Un}-${e}`,style:tn,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&E.jsx(rr,{rfId:e})]})}const cr=typeof document<"u"?document:null;var Qe=(e=null,t={target:cr})=>{const[n,o]=m.useState(!1),s=m.useRef(!1),i=m.useRef(new Set([])),[r,c]=m.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),a=u.reduce((d,h)=>d.concat(...h),[]);return[u,a]}return[[],[]]},[e]);return m.useEffect(()=>{var l,u;if(e!==null){const a=f=>{if(s.current=f.ctrlKey||f.metaKey||f.shiftKey,!s.current&&Ct(f))return!1;const p=on(f.code,c);i.current.add(f[p]),nn(r,i.current,!1)&&(f.preventDefault(),o(!0))},d=f=>{if(!s.current&&Ct(f))return!1;const p=on(f.code,c);nn(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[p]),f.key==="Meta"&&i.current.clear(),s.current=!1},h=()=>{i.current.clear(),o(!1)};return(l=t==null?void 0:t.target)==null||l.addEventListener("keydown",a),(u=t==null?void 0:t.target)==null||u.addEventListener("keyup",d),window.addEventListener("blur",h),()=>{var f,p;(f=t==null?void 0:t.target)==null||f.removeEventListener("keydown",a),(p=t==null?void 0:t.target)==null||p.removeEventListener("keyup",d),window.removeEventListener("blur",h)}}},[e,o]),n};function nn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function on(e,t){return t.includes(e)?"code":"key"}function Gn(e,t,n,o){var r,c;if(!e.parentNode)return n;const s=t.get(e.parentNode),i=je(s,o);return Gn(s,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(((r=s[J])==null?void 0:r.z)??0)>(n.z??0)?((c=s[J])==null?void 0:c.z)??0:n.z??0},o)}function qn(e,t,n){e.forEach(o=>{var s;if(o.parentNode&&!e.has(o.parentNode))throw new Error(`Parent node ${o.parentNode} not found`);if(o.parentNode||n!=null&&n[o.id]){const{x:i,y:r,z:c}=Gn(o,e,{...o.position,z:((s=o[J])==null?void 0:s.z)??0},t);o.positionAbsolute={x:i,y:r},o[J].z=c,n!=null&&n[o.id]&&(o[J].isParent=!0)}})}function St(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(c=>{var d;const l=(ae(c.zIndex)?c.zIndex:0)+(c.selected?r:0),u=t.get(c.id),a={width:u==null?void 0:u.width,height:u==null?void 0:u.height,...c,positionAbsolute:{x:c.position.x,y:c.position.y}};c.parentNode&&(a.parentNode=c.parentNode,i[c.parentNode]=!0),Object.defineProperty(a,J,{enumerable:!1,value:{handleBounds:(d=u==null?void 0:u[J])==null?void 0:d.handleBounds,z:l}}),s.set(c.id,a)}),qn(s,n,i),s}function Qn(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:c,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:a,nodeOrigin:d}=e(),h=t.initial&&!u&&a;if(c&&l&&(h||!t.initial)){const p=n().filter(x=>{var w;const S=t.includeHiddenNodes?x.width&&x.height:!x.hidden;return(w=t.nodes)!=null&&w.length?S&&t.nodes.some(N=>N.id===x.id):S}),g=p.every(x=>x.width&&x.height);if(p.length>0&&g){const x=Ot(p,d),[S,w,N]=On(x,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),v=He.translate(S,w).scale(N);return typeof t.duration=="number"&&t.duration>0?c.transform($e(l,t.duration),v):c.transform(l,v),!0}}return!1}function ar(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[J]:o[J],selected:n.selected})}),new Map(t)}function lr(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function ot({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:c,hasDefaultNodes:l,hasDefaultEdges:u}=n();e!=null&&e.length&&(l&&o({nodeInternals:ar(e,s)}),r==null||r(e)),t!=null&&t.length&&(u&&o({edges:lr(t,i)}),c==null||c(t))}const Ie=()=>{},ur={zoomIn:Ie,zoomOut:Ie,zoomTo:Ie,getZoom:()=>1,setViewport:Ie,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ie,fitBounds:Ie,project:e=>e,viewportInitialized:!1},dr=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),fr=()=>{const e=ne(),{d3Zoom:t,d3Selection:n}=G(dr,ie);return m.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy($e(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy($e(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo($e(n,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,c,l]=e.getState().transform,u=He.translate(s.x??r,s.y??c).scale(s.zoom??l);t.transform($e(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>Qn(e.getState,s),setCenter:(s,i,r)=>{const{width:c,height:l,maxZoom:u}=e.getState(),a=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:u,d=c/2-s*a,h=l/2-i*a,f=He.translate(d,h).scale(a);t.transform($e(n,r==null?void 0:r.duration),f)},fitBounds:(s,i)=>{const{width:r,height:c,minZoom:l,maxZoom:u}=e.getState(),[a,d,h]=On(s,r,c,l,u,(i==null?void 0:i.padding)??.1),f=He.translate(a,d).scale(h);t.transform($e(n,i==null?void 0:i.duration),f)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:c}=e.getState();return Tn(s,i,r,c)},viewportInitialized:!0}:ur,[t,n])};function Jn(){const e=fr(),t=ne(),n=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),o=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(x=>({...x}))},[]),i=m.useCallback(g=>{const{edges:x=[]}=t.getState();return x.find(S=>S.id===g)},[]),r=m.useCallback(g=>{const{getNodes:x,setNodes:S,hasDefaultNodes:w,onNodesChange:N}=t.getState(),v=x(),$=typeof g=="function"?g(v):g;if(w)S($);else if(N){const M=$.length===0?v.map(P=>({type:"remove",id:P.id})):$.map(P=>({item:P,type:"reset"}));N(M)}},[]),c=m.useCallback(g=>{const{edges:x=[],setEdges:S,hasDefaultEdges:w,onEdgesChange:N}=t.getState(),v=typeof g=="function"?g(x):g;if(w)S(v);else if(N){const $=v.length===0?x.map(M=>({type:"remove",id:M.id})):v.map(M=>({item:M,type:"reset"}));N($)}},[]),l=m.useCallback(g=>{const x=Array.isArray(g)?g:[g],{getNodes:S,setNodes:w,hasDefaultNodes:N,onNodesChange:v}=t.getState();if(N){const M=[...S(),...x];w(M)}else if(v){const $=x.map(M=>({item:M,type:"add"}));v($)}},[]),u=m.useCallback(g=>{const x=Array.isArray(g)?g:[g],{edges:S=[],setEdges:w,hasDefaultEdges:N,onEdgesChange:v}=t.getState();if(N)w([...S,...x]);else if(v){const $=x.map(M=>({item:M,type:"add"}));v($)}},[]),a=m.useCallback(()=>{const{getNodes:g,edges:x=[],transform:S}=t.getState(),[w,N,v]=S;return{nodes:g().map($=>({...$})),edges:x.map($=>({...$})),viewport:{x:w,y:N,zoom:v}}},[]),d=m.useCallback(({nodes:g,edges:x})=>{const{nodeInternals:S,getNodes:w,edges:N,hasDefaultNodes:v,hasDefaultEdges:$,onNodesDelete:M,onEdgesDelete:P,onNodesChange:T,onEdgesChange:D}=t.getState(),H=(g||[]).map(R=>R.id),A=(x||[]).map(R=>R.id),_=w().reduce((R,O)=>{const j=!H.includes(O.id)&&O.parentNode&&R.find(y=>y.id===O.parentNode);return(typeof O.deletable=="boolean"?O.deletable:!0)&&(H.includes(O.id)||j)&&R.push(O),R},[]),b=N.filter(R=>typeof R.deletable=="boolean"?R.deletable:!0),k=b.filter(R=>A.includes(R.id));if(_||k){const R=zn(_,b),O=[...k,...R],j=O.reduce((B,y)=>(B.includes(y.id)||B.push(y.id),B),[]);if(($||v)&&($&&t.setState({edges:N.filter(B=>!j.includes(B.id))}),v&&(_.forEach(B=>{S.delete(B.id)}),t.setState({nodeInternals:new Map(S)}))),j.length>0&&(P==null||P(O),D&&D(j.map(B=>({id:B,type:"remove"})))),_.length>0&&(M==null||M(_),T)){const B=_.map(y=>({id:y.id,type:"remove"}));T(B)}}},[]),h=m.useCallback(g=>{const x=_s(g),S=x?null:t.getState().nodeInternals.get(g.id);return[x?g:Kt(S),S,x]},[]),f=m.useCallback((g,x=!0,S)=>{const[w,N,v]=h(g);return w?(S||t.getState().getNodes()).filter($=>{if(!v&&($.id===N.id||!$.positionAbsolute))return!1;const M=Kt($),P=Nt(M,w);return x&&P>0||P>=g.width*g.height}):[]},[]),p=m.useCallback((g,x,S=!0)=>{const[w]=h(g);if(!w)return!1;const N=Nt(w,x);return S&&N>0||N>=g.width*g.height},[]);return m.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:c,addNodes:l,addEdges:u,toObject:a,deleteElements:d,getIntersectingNodes:f,isNodeIntersecting:p}),[e,n,o,s,i,r,c,l,u,a,d,f,p])}var gr=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ne(),{deleteElements:o}=Jn(),s=Qe(e),i=Qe(t);m.useEffect(()=>{if(s){const{edges:r,getNodes:c}=n.getState(),l=c().filter(a=>a.selected),u=r.filter(a=>a.selected);o({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function hr(e){const t=ne();m.useEffect(()=>{let n;const o=()=>{var i,r;if(!e.current)return;const s=_t(e.current);(s.height===0||s.width===0)&&((r=(i=t.getState()).onError)==null||r.call(i,"004",fe.error004())),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const jt={position:"absolute",width:"100%",height:"100%",top:0,left:0},pr=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,st=e=>({x:e.x,y:e.y,zoom:e.k}),ze=(e,t)=>e.target.closest(`.${t}`),sn=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),rn=e=>{const t=e.ctrlKey&&rt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},yr=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),mr=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:c=.5,panOnScrollMode:l=Pe.Free,zoomOnDoubleClick:u=!0,elementsSelectable:a,panOnDrag:d=!0,defaultViewport:h,translateExtent:f,minZoom:p,maxZoom:g,zoomActivationKeyCode:x,preventScrolling:S=!0,children:w,noWheelClassName:N,noPanClassName:v})=>{const $=m.useRef(),M=ne(),P=m.useRef(!1),T=m.useRef(!1),D=m.useRef(null),H=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:A,d3Selection:_,d3ZoomHandler:b,userSelectionActive:k}=G(yr,ie),R=Qe(x),O=m.useRef(0),j=m.useRef(!1),B=m.useRef();return hr(D),m.useEffect(()=>{if(D.current){const y=D.current.getBoundingClientRect(),C=Yo().scaleExtent([p,g]).translateExtent(f),I=mn(D.current).call(C),V=He.translate(h.x,h.y).scale(Fe(h.zoom,p,g)),F=[[0,0],[y.width,y.height]],Z=C.constrain()(V,F,f);C.transform(I,Z),C.wheelDelta(rn),M.setState({d3Zoom:C,d3Selection:I,d3ZoomHandler:I.on("wheel.zoom"),transform:[Z.x,Z.y,Z.k],domNode:D.current.closest(".react-flow")})}},[]),m.useEffect(()=>{_&&A&&(r&&!R&&!k?_.on("wheel.zoom",y=>{if(ze(y,N))return!1;y.preventDefault(),y.stopImmediatePropagation();const C=_.property("__zoom").k||1,I=rt();if(y.ctrlKey&&i&&I){const te=Zo(y),K=rn(y),re=C*Math.pow(2,K);A.scaleTo(_,re,te,y);return}const V=y.deltaMode===1?20:1;let F=l===Pe.Vertical?0:y.deltaX*V,Z=l===Pe.Horizontal?0:y.deltaY*V;!I&&y.shiftKey&&l!==Pe.Vertical&&(F=y.deltaY*V,Z=0),A.translateBy(_,-(F/C)*c,-(Z/C)*c,{internal:!0});const W=st(_.property("__zoom")),{onViewportChangeStart:U,onViewportChange:ee,onViewportChangeEnd:Q}=M.getState();clearTimeout(B.current),j.current||(j.current=!0,t==null||t(y,W),U==null||U(W)),j.current&&(e==null||e(y,W),ee==null||ee(W),B.current=setTimeout(()=>{n==null||n(y,W),Q==null||Q(W),j.current=!1},150))},{passive:!1}):typeof b<"u"&&_.on("wheel.zoom",function(y,C){if(!S||ze(y,N))return null;y.preventDefault(),b.call(this,y,C)},{passive:!1}))},[k,r,l,_,A,b,R,i,S,N,t,e,n]),m.useEffect(()=>{A&&A.on("start",y=>{var V,F;if(!y.sourceEvent||y.sourceEvent.internal)return null;O.current=(V=y.sourceEvent)==null?void 0:V.button;const{onViewportChangeStart:C}=M.getState(),I=st(y.transform);P.current=!0,H.current=I,((F=y.sourceEvent)==null?void 0:F.type)==="mousedown"&&M.setState({paneDragging:!0}),C==null||C(I),t==null||t(y.sourceEvent,I)})},[A,t]),m.useEffect(()=>{A&&(k&&!P.current?A.on("zoom",null):k||A.on("zoom",y=>{var I;const{onViewportChange:C}=M.getState();if(M.setState({transform:[y.transform.x,y.transform.y,y.transform.k]}),T.current=!!(o&&sn(d,O.current??0)),(e||C)&&!((I=y.sourceEvent)!=null&&I.internal)){const V=st(y.transform);C==null||C(V),e==null||e(y.sourceEvent,V)}}))},[k,A,e,d,o]),m.useEffect(()=>{A&&A.on("end",y=>{if(!y.sourceEvent||y.sourceEvent.internal)return null;const{onViewportChangeEnd:C}=M.getState();if(P.current=!1,M.setState({paneDragging:!1}),o&&sn(d,O.current??0)&&!T.current&&o(y.sourceEvent),T.current=!1,(n||C)&&pr(H.current,y.transform)){const I=st(y.transform);H.current=I,clearTimeout($.current),$.current=setTimeout(()=>{C==null||C(I),n==null||n(y.sourceEvent,I)},r?150:0)}})},[A,r,d,n,o]),m.useEffect(()=>{A&&A.filter(y=>{const C=R||s,I=i&&y.ctrlKey;if(y.button===1&&y.type==="mousedown"&&(ze(y,"react-flow__node")||ze(y,"react-flow__edge")))return!0;if(!d&&!C&&!r&&!u&&!i||k||!u&&y.type==="dblclick"||ze(y,N)&&y.type==="wheel"||ze(y,v)&&y.type!=="wheel"||!i&&y.ctrlKey&&y.type==="wheel"||!C&&!r&&!I&&y.type==="wheel"||!d&&(y.type==="mousedown"||y.type==="touchstart")||Array.isArray(d)&&!d.includes(y.button)&&(y.type==="mousedown"||y.type==="touchstart"))return!1;const V=Array.isArray(d)&&d.includes(y.button)||!y.button||y.button<=1;return(!y.ctrlKey||y.type==="wheel")&&V})},[k,A,s,i,r,u,d,a,R]),E.jsx("div",{className:"react-flow__renderer",ref:D,style:jt,children:w})},xr=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Sr(){const{userSelectionActive:e,userSelectionRect:t}=G(xr,ie);return e&&t?E.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function cn(e,t){const n=e.find(o=>o.id===t.parentNode);if(n){const o=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(o>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,o>0&&(n.style.width+=o),s>0&&(n.style.height+=s),t.position.x<0){const i=Math.abs(t.position.x);n.position.x=n.position.x-i,n.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);n.position.y=n.position.y-i,n.style.height+=i,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function br(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(c=>c.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const c of i)if(c)switch(c.type){case"select":{r.selected=c.selected;break}case"position":{typeof c.position<"u"&&(r.position=c.position),typeof c.positionAbsolute<"u"&&(r.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(r.dragging=c.dragging),r.expandParent&&cn(o,r);break}case"dimensions":{typeof c.dimensions<"u"&&(r.width=c.dimensions.width,r.height=c.dimensions.height),typeof c.updateStyle<"u"&&(r.style={...r.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(r.resizing=c.resizing),r.expandParent&&cn(o,r);break}case"remove":return o}return o.push(r),o},n)}function wr(e,t){return br(e,t)}const me=(e,t)=>({id:e,type:"select",selected:t});function Be(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(me(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(me(o.id,!1))),n},[])}const bt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Er=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),eo=m.memo(({isSelecting:e,selectionMode:t=qe.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:c,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:a,children:d})=>{const h=m.useRef(null),f=ne(),p=m.useRef(0),g=m.useRef(0),x=m.useRef(),{userSelectionActive:S,elementsSelectable:w,dragging:N}=G(Er,ie),v=()=>{f.setState({userSelectionActive:!1,userSelectionRect:null}),p.current=0,g.current=0},$=b=>{i==null||i(b),f.getState().resetSelectedElements(),f.setState({nodesSelectionActive:!1})},M=b=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){b.preventDefault();return}r==null||r(b)},P=c?b=>c(b):void 0,T=b=>{const{resetSelectedElements:k,domNode:R}=f.getState();if(x.current=R==null?void 0:R.getBoundingClientRect(),!w||!e||b.button!==0||b.target!==h.current||!x.current)return;const{x:O,y:j}=Se(b,x.current);k(),f.setState({userSelectionRect:{width:0,height:0,startX:O,startY:j,x:O,y:j}}),o==null||o(b)},D=b=>{const{userSelectionRect:k,nodeInternals:R,edges:O,transform:j,onNodesChange:B,onEdgesChange:y,nodeOrigin:C,getNodes:I}=f.getState();if(!e||!x.current||!k)return;f.setState({userSelectionActive:!0,nodesSelectionActive:!1});const V=Se(b,x.current),F=k.startX??0,Z=k.startY??0,W={...k,x:V.x<F?V.x:F,y:V.y<Z?V.y:Z,width:Math.abs(V.x-F),height:Math.abs(V.y-Z)},U=I(),ee=In(R,W,j,t===qe.Partial,!0,C),Q=zn(ee,O).map(K=>K.id),te=ee.map(K=>K.id);if(p.current!==te.length){p.current=te.length;const K=Be(U,te);K.length&&(B==null||B(K))}if(g.current!==Q.length){g.current=Q.length;const K=Be(O,Q);K.length&&(y==null||y(K))}f.setState({userSelectionRect:W})},H=b=>{if(b.button!==0)return;const{userSelectionRect:k}=f.getState();!S&&k&&b.target===h.current&&($==null||$(b)),f.setState({nodesSelectionActive:p.current>0}),v(),s==null||s(b)},A=b=>{S&&(f.setState({nodesSelectionActive:p.current>0}),s==null||s(b)),v()},_=w&&(e||S);return E.jsxs("div",{className:le(["react-flow__pane",{dragging:N,selection:e}]),onClick:_?void 0:bt($,h),onContextMenu:bt(M,h),onWheel:bt(P,h),onMouseEnter:_?void 0:l,onMouseDown:_?T:void 0,onMouseMove:_?D:u,onMouseUp:_?H:void 0,onMouseLeave:_?A:a,ref:h,style:jt,children:[d,E.jsx(Sr,{})]})});eo.displayName="Pane";function to(e,t){if(!e.parentNode)return!1;const n=t.get(e.parentNode);return n?n.selected?!0:to(n,t):!1}function an(e,t,n){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Nr(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||!to(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,r;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((r=s.positionAbsolute)==null?void 0:r.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function Cr(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function no(e,t,n,o,s=[0,0],i){const r=Cr(e,e.extent||o);let c=r;if(e.extent==="parent")if(e.parentNode&&e.width&&e.height){const a=n.get(e.parentNode),{x:d,y:h}=je(a,s).positionAbsolute;c=a&&ae(d)&&ae(h)&&ae(a.width)&&ae(a.height)?[[d+e.width*s[0],h+e.height*s[1]],[d+a.width-e.width+e.width*s[0],h+a.height-e.height+e.height*s[1]]]:c}else i==null||i("005",fe.error005()),c=r;else if(e.extent&&e.parentNode){const a=n.get(e.parentNode),{x:d,y:h}=je(a,s).positionAbsolute;c=[[e.extent[0][0]+d,e.extent[0][1]+h],[e.extent[1][0]+d,e.extent[1][1]+h]]}let l={x:0,y:0};if(e.parentNode){const a=n.get(e.parentNode);l=je(a,s).positionAbsolute}const u=c&&c!=="parent"?kt(t,c):t;return{position:{x:u.x-l.x,y:u.y-l.y},positionAbsolute:u}}function wt({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const ln=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),c={x:r.width*o[0],y:r.height*o[1]};return i.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-r.left-c.x)/n,y:(u.top-r.top-c.y)/n,..._t(l)}})};function Ue(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function $t({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:c,onError:l}=t.getState(),u=c.get(e);if(!u){l==null||l("012",fe.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&r)&&(i({nodes:[u]}),requestAnimationFrame(()=>{var a;return(a=o==null?void 0:o.current)==null?void 0:a.blur()})):s([e])}function Mr(){const e=ne();return m.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,l={x:(r-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(l.x/s[0]):l.x,ySnapped:i?s[1]*Math.round(l.y/s[1]):l.y,...l}},[])}function Et(e){return(t,n,o)=>e==null?void 0:e(t,o)}function oo({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const c=ne(),[l,u]=m.useState(!1),a=m.useRef([]),d=m.useRef({x:null,y:null}),h=m.useRef(0),f=m.useRef(null),p=m.useRef({x:0,y:0}),g=m.useRef(null),x=m.useRef(!1),S=Mr();return m.useEffect(()=>{if(e!=null&&e.current){const w=mn(e.current),N=({x:$,y:M})=>{const{nodeInternals:P,onNodeDrag:T,onSelectionDrag:D,updateNodePositions:H,nodeExtent:A,snapGrid:_,snapToGrid:b,nodeOrigin:k,onError:R}=c.getState();d.current={x:$,y:M};let O=!1,j={x:0,y:0,x2:0,y2:0};if(a.current.length>1&&A){const y=Ot(a.current,k);j=Dt(y)}if(a.current=a.current.map(y=>{const C={x:$-y.distance.x,y:M-y.distance.y};b&&(C.x=_[0]*Math.round(C.x/_[0]),C.y=_[1]*Math.round(C.y/_[1]));const I=[[A[0][0],A[0][1]],[A[1][0],A[1][1]]];a.current.length>1&&A&&!y.extent&&(I[0][0]=y.positionAbsolute.x-j.x+A[0][0],I[1][0]=y.positionAbsolute.x+(y.width??0)-j.x2+A[1][0],I[0][1]=y.positionAbsolute.y-j.y+A[0][1],I[1][1]=y.positionAbsolute.y+(y.height??0)-j.y2+A[1][1]);const V=no(y,C,P,I,k,R);return O=O||y.position.x!==V.position.x||y.position.y!==V.position.y,y.position=V.position,y.positionAbsolute=V.positionAbsolute,y}),!O)return;H(a.current,!0,!0),u(!0);const B=s?T:Et(D);if(B&&g.current){const[y,C]=wt({nodeId:s,dragItems:a.current,nodeInternals:P});B(g.current,y,C)}},v=()=>{if(!f.current)return;const[$,M]=vn(p.current,f.current);if($!==0||M!==0){const{transform:P,panBy:T}=c.getState();d.current.x=(d.current.x??0)-$/P[2],d.current.y=(d.current.y??0)-M/P[2],T({x:$,y:M})&&N(d.current)}h.current=requestAnimationFrame(v)};if(t)w.on(".drag",null);else{const $=Wo().on("start",M=>{var O;const{nodeInternals:P,multiSelectionActive:T,domNode:D,nodesDraggable:H,unselectNodesAndEdges:A,onNodeDragStart:_,onSelectionDragStart:b}=c.getState(),k=s?_:Et(b);!r&&!T&&s&&((O=P.get(s))!=null&&O.selected||A()),s&&i&&r&&$t({id:s,store:c,nodeRef:e});const R=S(M);if(d.current=R,a.current=Nr(P,H,R,s),k&&a.current){const[j,B]=wt({nodeId:s,dragItems:a.current,nodeInternals:P});k(M.sourceEvent,j,B)}f.current=(D==null?void 0:D.getBoundingClientRect())||null,p.current=Se(M.sourceEvent,f.current)}).on("drag",M=>{const P=S(M),{autoPanOnNodeDrag:T}=c.getState();!x.current&&T&&(x.current=!0,v()),(d.current.x!==P.xSnapped||d.current.y!==P.ySnapped)&&a.current&&(g.current=M.sourceEvent,p.current=Se(M.sourceEvent,f.current),N(P))}).on("end",M=>{if(u(!1),x.current=!1,cancelAnimationFrame(h.current),a.current){const{updateNodePositions:P,nodeInternals:T,onNodeDragStop:D,onSelectionDragStop:H}=c.getState(),A=s?D:Et(H);if(P(a.current,!1,!1),A){const[_,b]=wt({nodeId:s,dragItems:a.current,nodeInternals:T});A(M.sourceEvent,_,b)}}}).filter(M=>{const P=M.target;return!M.button&&(!n||!an(P,`.${n}`,e))&&(!o||an(P,o,e))});return w.call($),()=>{w.on(".drag",null)}}}},[e,t,n,o,i,c,s,r,S]),l}function so(){const e=ne();return m.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:c,snapGrid:l,onError:u,nodesDraggable:a}=e.getState(),d=r().filter(w=>w.selected&&(w.draggable||a&&typeof w.draggable>"u")),h=c?l[0]:5,f=c?l[1]:5,p=n.isShiftPressed?4:1,g=n.x*h*p,x=n.y*f*p,S=d.map(w=>{if(w.positionAbsolute){const N={x:w.positionAbsolute.x+g,y:w.positionAbsolute.y+x};c&&(N.x=l[0]*Math.round(N.x/l[0]),N.y=l[1]*Math.round(N.y/l[1]));const{positionAbsolute:v,position:$}=no(w,N,o,s,void 0,u);w.position=$,w.positionAbsolute=v}return w});i(S,!0,!1)},[])}const Le={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ge=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:c,yPosOrigin:l,selected:u,onClick:a,onMouseEnter:d,onMouseMove:h,onMouseLeave:f,onContextMenu:p,onDoubleClick:g,style:x,className:S,isDraggable:w,isSelectable:N,isConnectable:v,isFocusable:$,selectNodesOnDrag:M,sourcePosition:P,targetPosition:T,hidden:D,resizeObserver:H,dragHandle:A,zIndex:_,isParent:b,noDragClassName:k,noPanClassName:R,initialized:O,disableKeyboardA11y:j,ariaLabel:B,rfId:y})=>{const C=ne(),I=m.useRef(null),V=m.useRef(P),F=m.useRef(T),Z=m.useRef(o),W=N||w||a||d||h||f,U=so(),ee=Ue(n,C.getState,d),Q=Ue(n,C.getState,h),te=Ue(n,C.getState,f),K=Ue(n,C.getState,p),re=Ue(n,C.getState,g),ue=X=>{if(N&&(!M||!w)&&$t({id:n,store:C,nodeRef:I}),a){const se=C.getState().nodeInternals.get(n);se&&a(X,{...se})}},de=X=>{if(!Ct(X))if($n.includes(X.key)&&N){const se=X.key==="Escape";$t({id:n,store:C,unselect:se,nodeRef:I})}else!j&&w&&u&&Object.prototype.hasOwnProperty.call(Le,X.key)&&(C.setState({ariaLiveMessage:`Moved selected node ${X.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),U({x:Le[X.key].x,y:Le[X.key].y,isShiftPressed:X.shiftKey}))};m.useEffect(()=>{if(I.current&&!D){const X=I.current;return H==null||H.observe(X),()=>H==null?void 0:H.unobserve(X)}},[D]),m.useEffect(()=>{const X=Z.current!==o,se=V.current!==P,L=F.current!==T;I.current&&(X||se||L)&&(X&&(Z.current=o),se&&(V.current=P),L&&(F.current=T),C.getState().updateNodeDimensions([{id:n,nodeElement:I.current,forceUpdate:!0}]))},[n,o,P,T]);const q=oo({nodeRef:I,disabled:D||!w,noDragClassName:k,handleSelector:A,nodeId:n,isSelectable:N,selectNodesOnDrag:M});return D?null:E.jsx("div",{className:le(["react-flow__node",`react-flow__node-${o}`,{[R]:w},S,{selected:u,selectable:N,parent:b,dragging:q}]),ref:I,style:{zIndex:_,transform:`translate(${c}px,${l}px)`,pointerEvents:W?"all":"none",visibility:O?"visible":"hidden",...x},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ee,onMouseMove:Q,onMouseLeave:te,onContextMenu:K,onClick:ue,onDoubleClick:re,onKeyDown:$?de:void 0,tabIndex:$?0:void 0,role:$?"button":void 0,"aria-describedby":j?void 0:`${Kn}-${y}`,"aria-label":B,children:E.jsx(Os,{value:n,children:E.jsx(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:u,isConnectable:v,sourcePosition:P,targetPosition:T,dragging:q,dragHandle:A,zIndex:_})})})};return t.displayName="NodeWrapper",m.memo(t)};const vr=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Ot(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ar({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:i,x:r,y:c,transformString:l,userSelectionActive:u}=G(vr,ie),a=so(),d=m.useRef(null);if(m.useEffect(()=>{var p;n||(p=d.current)==null||p.focus({preventScroll:!0})},[n]),oo({nodeRef:d}),u||!s||!i)return null;const h=e?p=>{const g=o.getState().getNodes().filter(x=>x.selected);e(p,g)}:void 0,f=p=>{Object.prototype.hasOwnProperty.call(Le,p.key)&&a({x:Le[p.key].x,y:Le[p.key].y,isShiftPressed:p.shiftKey})};return E.jsx("div",{className:le(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l},children:E.jsx("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:s,height:i,top:c,left:r}})})}var $r=m.memo(Ar);const Pr=e=>e.nodesSelectionActive,ro=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:c,onMove:l,onMoveStart:u,onMoveEnd:a,selectionKeyCode:d,selectionOnDrag:h,selectionMode:f,onSelectionStart:p,onSelectionEnd:g,multiSelectionKeyCode:x,panActivationKeyCode:S,zoomActivationKeyCode:w,elementsSelectable:N,zoomOnScroll:v,zoomOnPinch:$,panOnScroll:M,panOnScrollSpeed:P,panOnScrollMode:T,zoomOnDoubleClick:D,panOnDrag:H,defaultViewport:A,translateExtent:_,minZoom:b,maxZoom:k,preventScrolling:R,onSelectionContextMenu:O,noWheelClassName:j,noPanClassName:B,disableKeyboardA11y:y})=>{const C=G(Pr),I=Qe(d),F=Qe(S)||H,Z=I||h&&F!==!0;return gr({deleteKeyCode:c,multiSelectionKeyCode:x}),E.jsx(mr,{onMove:l,onMoveStart:u,onMoveEnd:a,onPaneContextMenu:i,elementsSelectable:N,zoomOnScroll:v,zoomOnPinch:$,panOnScroll:M,panOnScrollSpeed:P,panOnScrollMode:T,zoomOnDoubleClick:D,panOnDrag:!I&&F,defaultViewport:A,translateExtent:_,minZoom:b,maxZoom:k,zoomActivationKeyCode:w,preventScrolling:R,noWheelClassName:j,noPanClassName:B,children:E.jsxs(eo,{onSelectionStart:p,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:F,isSelecting:!!Z,selectionMode:f,children:[e,C&&E.jsx($r,{onSelectionContextMenu:O,noPanClassName:B,disableKeyboardA11y:y})]})})};ro.displayName="FlowRenderer";var _r=m.memo(ro);function kr(e){return G(m.useCallback(n=>e?In(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Dr(e){const t={input:Ge(e.input||Yn),default:Ge(e.default||At),output:Ge(e.output||Wn),group:Ge(e.group||Ht)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=Ge(e[i]||At),s),n);return{...t,...o}}const Rr=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},Tr=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),io=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=G(Tr,ie),c=kr(e.onlyRenderVisibleElements),l=m.useRef(),u=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const a=new ResizeObserver(d=>{const h=d.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));i(h)});return l.current=a,a},[]);return m.useEffect(()=>()=>{var a;(a=l==null?void 0:l.current)==null||a.disconnect()},[]),E.jsx("div",{className:"react-flow__nodes",style:jt,children:c.map(a=>{var $,M;let d=a.type||"default";e.nodeTypes[d]||(r==null||r("003",fe.error003(d)),d="default");const h=e.nodeTypes[d]||e.nodeTypes.default,f=!!(a.draggable||t&&typeof a.draggable>"u"),p=!!(a.selectable||s&&typeof a.selectable>"u"),g=!!(a.connectable||n&&typeof a.connectable>"u"),x=!!(a.focusable||o&&typeof a.focusable>"u"),S=e.nodeExtent?kt(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,w=(S==null?void 0:S.x)??0,N=(S==null?void 0:S.y)??0,v=Rr({x:w,y:N,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return E.jsx(h,{id:a.id,className:a.className,style:a.style,type:d,data:a.data,sourcePosition:a.sourcePosition||z.Bottom,targetPosition:a.targetPosition||z.Top,hidden:a.hidden,xPos:w,yPos:N,xPosOrigin:v.x,yPosOrigin:v.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:f,isSelectable:p,isConnectable:g,isFocusable:x,resizeObserver:u,dragHandle:a.dragHandle,zIndex:(($=a[J])==null?void 0:$.z)??0,isParent:!!((M=a[J])!=null&&M.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel},a.id)})})};io.displayName="NodeRenderer";var Ir=m.memo(io);const zr=(e,t,n)=>n===z.Left?e-t:n===z.Right?e+t:e,Or=(e,t,n)=>n===z.Top?e-t:n===z.Bottom?e+t:e,un="react-flow__edgeupdater",dn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:c})=>E.jsx("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:le([un,`${un}-${c}`]),cx:zr(t,o,e),cy:Or(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),Br=()=>!0;var Oe=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:c,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:g,style:x,source:S,target:w,sourceX:N,sourceY:v,targetX:$,targetY:M,sourcePosition:P,targetPosition:T,elementsSelectable:D,hidden:H,sourceHandleId:A,targetHandleId:_,onContextMenu:b,onMouseEnter:k,onMouseMove:R,onMouseLeave:O,edgeUpdaterRadius:j,onEdgeUpdate:B,onEdgeUpdateStart:y,onEdgeUpdateEnd:C,markerEnd:I,markerStart:V,rfId:F,ariaLabel:Z,isFocusable:W,isUpdatable:U,pathOptions:ee,interactionWidth:Q})=>{const te=m.useRef(null),[K,re]=m.useState(!1),[ue,de]=m.useState(!1),q=ne(),X=m.useMemo(()=>`url(#${vt(V,F)})`,[V,F]),se=m.useMemo(()=>`url(#${vt(I,F)})`,[I,F]);if(H)return null;const L=oe=>{const{edges:ce,addSelectedEdges:Ne}=q.getState();if(D&&(q.setState({nodesSelectionActive:!1}),Ne([n])),r){const Ce=ce.find(Me=>Me.id===n);r(oe,Ce)}},ge=Ke(n,q.getState,c),be=Ke(n,q.getState,b),Ye=Ke(n,q.getState,k),Ze=Ke(n,q.getState,R),ke=Ke(n,q.getState,O),we=(oe,ce)=>{if(oe.button!==0)return;const{edges:Ne,isValidConnection:Ce}=q.getState(),Me=ce?w:S,et=(ce?_:A)||null,ve=ce?"target":"source",gt=Ce||Br,ht=ce,Xe=Ne.find(Ae=>Ae.id===n);de(!0),y==null||y(oe,Xe,ve);const pt=Ae=>{de(!1),C==null||C(Ae,Xe,ve)};jn({event:oe,handleId:et,nodeId:Me,onConnect:Ae=>B==null?void 0:B(Xe,Ae),isTarget:ht,getState:q.getState,setState:q.setState,isValidConnection:gt,edgeUpdaterType:ve,onEdgeUpdateEnd:pt})},he=oe=>we(oe,!0),De=oe=>we(oe,!1),pe=()=>re(!0),Ee=()=>re(!1),We=!D&&!r,Re=oe=>{var ce;if($n.includes(oe.key)&&D){const{unselectNodesAndEdges:Ne,addSelectedEdges:Ce,edges:Me}=q.getState();oe.key==="Escape"?((ce=te.current)==null||ce.blur(),Ne({edges:[Me.find(ve=>ve.id===n)]})):Ce([n])}};return E.jsxs("g",{className:le(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:l,animated:u,inactive:We,updating:K}]),onClick:L,onDoubleClick:ge,onContextMenu:be,onMouseEnter:Ye,onMouseMove:Ze,onMouseLeave:ke,onKeyDown:W?Re:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":Z===null?void 0:Z||`Edge from ${S} to ${w}`,"aria-describedby":W?`${Un}-${F}`:void 0,ref:te,children:[!ue&&E.jsx(e,{id:n,source:S,target:w,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:g,data:i,style:x,sourceX:N,sourceY:v,targetX:$,targetY:M,sourcePosition:P,targetPosition:T,sourceHandleId:A,targetHandleId:_,markerStart:X,markerEnd:se,pathOptions:ee,interactionWidth:Q}),U&&E.jsxs(E.Fragment,{children:[(U==="source"||U===!0)&&E.jsx(dn,{position:P,centerX:N,centerY:v,radius:j,onMouseDown:he,onMouseEnter:pe,onMouseOut:Ee,type:"source"}),(U==="target"||U===!0)&&E.jsx(dn,{position:T,centerX:$,centerY:M,radius:j,onMouseDown:De,onMouseEnter:pe,onMouseOut:Ee,type:"target"})]})]})};return t.displayName="EdgeWrapper",m.memo(t)};function Hr(e){const t={default:Oe(e.default||ct),straight:Oe(e.bezier||It),step:Oe(e.step||Tt),smoothstep:Oe(e.step||ft),simplebezier:Oe(e.simplebezier||Rt)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=Oe(e[i]||ct),s),n);return{...t,...o}}function fn(e,t,n=null){const o=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,r=(n==null?void 0:n.height)||t.height;switch(e){case z.Top:return{x:o+i/2,y:s};case z.Right:return{x:o+i,y:s+r/2};case z.Bottom:return{x:o+i/2,y:s+r};case z.Left:return{x:o,y:s+r/2}}}function gn(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const jr=(e,t,n,o,s,i)=>{const r=fn(n,e,t),c=fn(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:c.x,targetY:c.y}};function Lr({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:c,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const a=Dt({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:r/l[2],height:c/l[2]}),d=Math.max(0,Math.min(a.x2,u.x2)-Math.max(a.x,u.x)),h=Math.max(0,Math.min(a.y2,u.y2)-Math.max(a.y,u.y));return Math.ceil(d*h)>0}function hn(e){var o,s,i,r,c;const t=((o=e==null?void 0:e[J])==null?void 0:o.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((r=e==null?void 0:e.positionAbsolute)==null?void 0:r.x)||0,y:((c=e==null?void 0:e.positionAbsolute)==null?void 0:c.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const Vr=[{level:0,isMaxLevel:!0,edges:[]}];function Fr(e,t,n=!1){let o=-1;const s=e.reduce((r,c)=>{var a,d;const l=ae(c.zIndex);let u=l?c.zIndex:0;if(n){const h=t.get(c.target),f=t.get(c.source),p=c.selected||(h==null?void 0:h.selected)||(f==null?void 0:f.selected),g=Math.max(((a=f==null?void 0:f[J])==null?void 0:a.z)||0,((d=h==null?void 0:h[J])==null?void 0:d.z)||0,1e3);u=(l?c.zIndex:0)+(p?g:0)}return r[u]?r[u].push(c):r[u]=[c],o=u>o?u:o,r},{}),i=Object.entries(s).map(([r,c])=>{const l=+r;return{edges:c,level:l,isMaxLevel:l===o}});return i.length===0?Vr:i}function Yr(e,t,n){const o=G(m.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),c=t.get(i.target);return(r==null?void 0:r.width)&&(r==null?void 0:r.height)&&(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&Lr({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return Fr(o,t,n)}const Zr=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:"none",points:"-5,-4 0,0 -5,4"}),Wr=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:e,points:"-5,-4 0,0 -5,4 -5,-4"}),pn={[it.Arrow]:Zr,[it.ArrowClosed]:Wr};function Xr(e){const t=ne();return m.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(pn,e)?pn[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",fe.error009(e)),null)},[e])}const Kr=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:c="auto-start-reverse"})=>{const l=Xr(t);return l?E.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0",children:E.jsx(l,{color:n,strokeWidth:r})}):null},Ur=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const c=vt(r,t);o.includes(c)||(s.push({id:c,color:r.color||e,...r}),o.push(c))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},co=({defaultColor:e,rfId:t})=>{const n=G(m.useCallback(Ur({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return E.jsx("defs",{children:n.map(o=>E.jsx(Kr,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})};co.displayName="MarkerDefinitions";var Gr=m.memo(co);const qr=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),ao=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeUpdate:r,onEdgeContextMenu:c,onEdgeMouseEnter:l,onEdgeMouseMove:u,onEdgeMouseLeave:a,onEdgeClick:d,edgeUpdaterRadius:h,onEdgeDoubleClick:f,onEdgeUpdateStart:p,onEdgeUpdateEnd:g,children:x})=>{const{edgesFocusable:S,edgesUpdatable:w,elementsSelectable:N,width:v,height:$,connectionMode:M,nodeInternals:P,onError:T}=G(qr,ie),D=Yr(t,P,n);return v?E.jsxs(E.Fragment,{children:[D.map(({level:H,edges:A,isMaxLevel:_})=>E.jsxs("svg",{style:{zIndex:H},width:v,height:$,className:"react-flow__edges react-flow__container",children:[_&&E.jsx(Gr,{defaultColor:e,rfId:o}),E.jsx("g",{children:A.map(b=>{const[k,R,O]=hn(P.get(b.source)),[j,B,y]=hn(P.get(b.target));if(!O||!y)return null;let C=b.type||"default";s[C]||(T==null||T("011",fe.error011(C)),C="default");const I=s[C]||s.default,V=M===_e.Strict?B.target:(B.target??[]).concat(B.source??[]),F=gn(R.source,b.sourceHandle),Z=gn(V,b.targetHandle),W=(F==null?void 0:F.position)||z.Bottom,U=(Z==null?void 0:Z.position)||z.Top,ee=!!(b.focusable||S&&typeof b.focusable>"u"),Q=typeof r<"u"&&(b.updatable||w&&typeof b.updatable>"u");if(!F||!Z)return T==null||T("008",fe.error008(F,b)),null;const{sourceX:te,sourceY:K,targetX:re,targetY:ue}=jr(k,F,W,j,Z,U);return E.jsx(I,{id:b.id,className:le([b.className,i]),type:C,data:b.data,selected:!!b.selected,animated:!!b.animated,hidden:!!b.hidden,label:b.label,labelStyle:b.labelStyle,labelShowBg:b.labelShowBg,labelBgStyle:b.labelBgStyle,labelBgPadding:b.labelBgPadding,labelBgBorderRadius:b.labelBgBorderRadius,style:b.style,source:b.source,target:b.target,sourceHandleId:b.sourceHandle,targetHandleId:b.targetHandle,markerEnd:b.markerEnd,markerStart:b.markerStart,sourceX:te,sourceY:K,targetX:re,targetY:ue,sourcePosition:W,targetPosition:U,elementsSelectable:N,onEdgeUpdate:r,onContextMenu:c,onMouseEnter:l,onMouseMove:u,onMouseLeave:a,onClick:d,edgeUpdaterRadius:h,onEdgeDoubleClick:f,onEdgeUpdateStart:p,onEdgeUpdateEnd:g,rfId:o,ariaLabel:b.ariaLabel,isFocusable:ee,isUpdatable:Q,pathOptions:"pathOptions"in b?b.pathOptions:void 0,interactionWidth:b.interactionWidth},b.id)})})]},H)),x]}):null};ao.displayName="EdgeRenderer";var Qr=m.memo(ao);const Jr=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ei({children:e}){const t=G(Jr);return E.jsx("div",{className:"react-flow__viewport react-flow__container",style:{transform:t},children:e})}function ti(e){const t=Jn(),n=m.useRef(!1);m.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const ni={[z.Left]:z.Right,[z.Right]:z.Left,[z.Top]:z.Bottom,[z.Bottom]:z.Top},lo=({nodeId:e,handleType:t,style:n,type:o=xe.Bezier,CustomComponent:s,connectionStatus:i})=>{var M,P,T;const{fromNode:r,handleId:c,toX:l,toY:u,connectionMode:a}=G(m.useCallback(D=>({fromNode:D.nodeInternals.get(e),handleId:D.connectionHandleId,toX:(D.connectionPosition.x-D.transform[0])/D.transform[2],toY:(D.connectionPosition.y-D.transform[1])/D.transform[2],connectionMode:D.connectionMode}),[e]),ie),d=(M=r==null?void 0:r[J])==null?void 0:M.handleBounds;let h=d==null?void 0:d[t];if(a===_e.Loose&&(h=h||(d==null?void 0:d[t==="source"?"target":"source"])),!r||!h)return null;const f=c?h.find(D=>D.id===c):h[0],p=f?f.x+f.width/2:(r.width??0)/2,g=f?f.y+f.height/2:r.height??0,x=(((P=r.positionAbsolute)==null?void 0:P.x)??0)+p,S=(((T=r.positionAbsolute)==null?void 0:T.y)??0)+g,w=f==null?void 0:f.position,N=w?ni[w]:null;if(!w||!N)return null;if(s)return E.jsx(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:f,fromX:x,fromY:S,toX:l,toY:u,fromPosition:w,toPosition:N,connectionStatus:i});let v="";const $={sourceX:x,sourceY:S,sourcePosition:w,targetX:l,targetY:u,targetPosition:N};return o===xe.Bezier?[v]=Rn($):o===xe.Step?[v]=Mt({...$,borderRadius:0}):o===xe.SmoothStep?[v]=Mt($):o===xe.SimpleBezier?[v]=Dn($):v=`M${x},${S} ${l},${u}`,E.jsx("path",{d:v,fill:"none",className:"react-flow__connection-path",style:n})};lo.displayName="ConnectionLine";const oi=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function si({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:c,height:l,connectionStatus:u}=G(oi,ie);return!(s&&i&&c&&r)?null:E.jsx("svg",{style:e,width:c,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container",children:E.jsx("g",{className:le(["react-flow__connection",u]),children:E.jsx(lo,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:u})})})}function yn(e,t){return m.useRef(null),ne(),m.useMemo(()=>t(e),[e])}const uo=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:c,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:h,onNodeContextMenu:f,onSelectionContextMenu:p,onSelectionStart:g,onSelectionEnd:x,connectionLineType:S,connectionLineStyle:w,connectionLineComponent:N,connectionLineContainerStyle:v,selectionKeyCode:$,selectionOnDrag:M,selectionMode:P,multiSelectionKeyCode:T,panActivationKeyCode:D,zoomActivationKeyCode:H,deleteKeyCode:A,onlyRenderVisibleElements:_,elementsSelectable:b,selectNodesOnDrag:k,defaultViewport:R,translateExtent:O,minZoom:j,maxZoom:B,preventScrolling:y,defaultMarkerColor:C,zoomOnScroll:I,zoomOnPinch:V,panOnScroll:F,panOnScrollSpeed:Z,panOnScrollMode:W,zoomOnDoubleClick:U,panOnDrag:ee,onPaneClick:Q,onPaneMouseEnter:te,onPaneMouseMove:K,onPaneMouseLeave:re,onPaneScroll:ue,onPaneContextMenu:de,onEdgeUpdate:q,onEdgeContextMenu:X,onEdgeMouseEnter:se,onEdgeMouseMove:L,onEdgeMouseLeave:ge,edgeUpdaterRadius:be,onEdgeUpdateStart:Ye,onEdgeUpdateEnd:Ze,noDragClassName:ke,noWheelClassName:we,noPanClassName:he,elevateEdgesOnSelect:De,disableKeyboardA11y:pe,nodeOrigin:Ee,nodeExtent:We,rfId:Re})=>{const oe=yn(e,Dr),ce=yn(t,Hr);return ti(i),E.jsx(_r,{onPaneClick:Q,onPaneMouseEnter:te,onPaneMouseMove:K,onPaneMouseLeave:re,onPaneContextMenu:de,onPaneScroll:ue,deleteKeyCode:A,selectionKeyCode:$,selectionOnDrag:M,selectionMode:P,onSelectionStart:g,onSelectionEnd:x,multiSelectionKeyCode:T,panActivationKeyCode:D,zoomActivationKeyCode:H,elementsSelectable:b,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:I,zoomOnPinch:V,zoomOnDoubleClick:U,panOnScroll:F,panOnScrollSpeed:Z,panOnScrollMode:W,panOnDrag:ee,defaultViewport:R,translateExtent:O,minZoom:j,maxZoom:B,onSelectionContextMenu:p,preventScrolling:y,noDragClassName:ke,noWheelClassName:we,noPanClassName:he,disableKeyboardA11y:pe,children:E.jsxs(ei,{children:[E.jsx(Qr,{edgeTypes:ce,onEdgeClick:c,onEdgeDoubleClick:u,onEdgeUpdate:q,onlyRenderVisibleElements:_,onEdgeContextMenu:X,onEdgeMouseEnter:se,onEdgeMouseMove:L,onEdgeMouseLeave:ge,onEdgeUpdateStart:Ye,onEdgeUpdateEnd:Ze,edgeUpdaterRadius:be,defaultMarkerColor:C,noPanClassName:he,elevateEdgesOnSelect:!!De,disableKeyboardA11y:pe,rfId:Re,children:E.jsx(si,{style:w,type:S,component:N,containerStyle:v})}),E.jsx("div",{className:"react-flow__edgelabel-renderer"}),E.jsx(Ir,{nodeTypes:oe,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:h,onNodeContextMenu:f,selectNodesOnDrag:k,onlyRenderVisibleElements:_,noPanClassName:he,noDragClassName:ke,disableKeyboardA11y:pe,nodeOrigin:Ee,nodeExtent:We,rfId:Re})]})})};uo.displayName="GraphView";var ri=m.memo(uo);const Pt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ye={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Pt,nodeExtent:Pt,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:_e.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:ks,isValidConnection:void 0},ii=()=>ws((e,t)=>({...ye,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:St(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?St(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:c,domNode:l,nodeOrigin:u}=t(),a=l==null?void 0:l.querySelector(".react-flow__viewport");if(!a)return;const d=window.getComputedStyle(a),{m22:h}=new window.DOMMatrixReadOnly(d.transform),f=n.reduce((g,x)=>{const S=s.get(x.id);if(S){const w=_t(x.nodeElement);!!(w.width&&w.height&&(S.width!==w.width||S.height!==w.height||x.forceUpdate))&&(s.set(S.id,{...S,[J]:{...S[J],handleBounds:{source:ln(".source",x.nodeElement,h,u),target:ln(".target",x.nodeElement,h,u)}},...w}),g.push({id:S.id,type:"dimensions",dimensions:w}))}return g},[]);qn(s,u);const p=r||i&&!r&&Qn(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:p}),(f==null?void 0:f.length)>0&&(o==null||o(f))},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(c=>{const l={id:c.id,type:"position",dragging:s};return o&&(l.positionAbsolute=c.positionAbsolute,l.position=c.position),l});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:c,elevateNodesOnSelect:l}=t();if(n!=null&&n.length){if(i){const u=wr(n,c()),a=St(u,s,r,l);e({nodeInternals:a})}o==null||o(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>me(l,!0)):(r=Be(i(),n),c=Be(s,[])),ot({changedNodes:r,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>me(l,!0)):(r=Be(s,n),c=Be(i(),[])),ot({changedNodes:c,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),c=o||s,l=r.map(a=>(a.selected=!1,me(a.id,!1))),u=c.map(a=>me(a.id,!1));ot({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o==null||o.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o==null||o.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var o;(o=t().d3Zoom)==null||o.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(c=>c.selected).map(c=>me(c.id,!1)),r=n.filter(c=>c.selected).map(c=>me(c.id,!1));ot({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=kt(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:c,translateExtent:l}=t();if(!r||!c||!n.x&&!n.y)return!1;const u=He.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),a=[[0,0],[s,i]],d=r==null?void 0:r.constrain()(u,a,l);return r.transform(c,d),o[0]!==d.x||o[1]!==d.y||o[2]!==d.k},cancelConnection:()=>e({connectionNodeId:ye.connectionNodeId,connectionHandleId:ye.connectionHandleId,connectionHandleType:ye.connectionHandleType,connectionStatus:ye.connectionStatus,connectionStartHandle:ye.connectionStartHandle,connectionEndHandle:ye.connectionEndHandle}),reset:()=>e({...ye})}),Object.is),fo=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=ii()),E.jsx(Es,{value:t.current,children:e})};fo.displayName="ReactFlowProvider";const go=({children:e})=>m.useContext(dt)?E.jsx(E.Fragment,{children:e}):E.jsx(fo,{children:e});go.displayName="ReactFlowWrapper";const ci={input:Yn,default:At,output:Wn,group:Ht},ai={default:ct,straight:It,step:Tt,smoothstep:ft,simplebezier:Rt},li=[0,0],ui=[15,15],di={x:0,y:0,zoom:1},fi={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},gi=m.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=ci,edgeTypes:r=ai,onNodeClick:c,onEdgeClick:l,onInit:u,onMove:a,onMoveStart:d,onMoveEnd:h,onConnect:f,onConnectStart:p,onConnectEnd:g,onClickConnectStart:x,onClickConnectEnd:S,onNodeMouseEnter:w,onNodeMouseMove:N,onNodeMouseLeave:v,onNodeContextMenu:$,onNodeDoubleClick:M,onNodeDragStart:P,onNodeDrag:T,onNodeDragStop:D,onNodesDelete:H,onEdgesDelete:A,onSelectionChange:_,onSelectionDragStart:b,onSelectionDrag:k,onSelectionDragStop:R,onSelectionContextMenu:O,onSelectionStart:j,onSelectionEnd:B,connectionMode:y=_e.Strict,connectionLineType:C=xe.Bezier,connectionLineStyle:I,connectionLineComponent:V,connectionLineContainerStyle:F,deleteKeyCode:Z="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:U=!1,selectionMode:ee=qe.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:te=rt()?"Meta":"Control",zoomActivationKeyCode:K=rt()?"Meta":"Control",snapToGrid:re=!1,snapGrid:ue=ui,onlyRenderVisibleElements:de=!1,selectNodesOnDrag:q=!0,nodesDraggable:X,nodesConnectable:se,nodesFocusable:L,nodeOrigin:ge=li,edgesFocusable:be,edgesUpdatable:Ye,elementsSelectable:Ze,defaultViewport:ke=di,minZoom:we=.5,maxZoom:he=2,translateExtent:De=Pt,preventScrolling:pe=!0,nodeExtent:Ee,defaultMarkerColor:We="#b1b1b7",zoomOnScroll:Re=!0,zoomOnPinch:oe=!0,panOnScroll:ce=!1,panOnScrollSpeed:Ne=.5,panOnScrollMode:Ce=Pe.Free,zoomOnDoubleClick:Me=!0,panOnDrag:et=!0,onPaneClick:ve,onPaneMouseEnter:gt,onPaneMouseMove:ht,onPaneMouseLeave:Xe,onPaneScroll:pt,onPaneContextMenu:Lt,children:Ae,onEdgeUpdate:ho,onEdgeContextMenu:po,onEdgeDoubleClick:yo,onEdgeMouseEnter:mo,onEdgeMouseMove:xo,onEdgeMouseLeave:So,onEdgeUpdateStart:bo,onEdgeUpdateEnd:wo,edgeUpdaterRadius:Eo=10,onNodesChange:No,onEdgesChange:Co,noDragClassName:Mo="nodrag",noWheelClassName:vo="nowheel",noPanClassName:Vt="nopan",fitView:Ao=!1,fitViewOptions:$o,connectOnClick:Po=!0,attributionPosition:_o,proOptions:ko,defaultEdgeOptions:Do,elevateNodesOnSelect:Ro=!0,elevateEdgesOnSelect:To=!1,disableKeyboardA11y:Ft=!1,autoPanOnConnect:Io=!0,autoPanOnNodeDrag:zo=!0,connectionRadius:Oo=20,isValidConnection:Bo,onError:Ho,style:jo,id:Yt,...Lo},Vo)=>{const yt=Yt||"1";return E.jsx("div",{...Lo,style:{...jo,...fi},ref:Vo,className:le(["react-flow",s]),"data-testid":"rf__wrapper",id:Yt,children:E.jsxs(go,{children:[E.jsx(ri,{onInit:u,onMove:a,onMoveStart:d,onMoveEnd:h,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:N,onNodeMouseLeave:v,onNodeContextMenu:$,onNodeDoubleClick:M,nodeTypes:i,edgeTypes:r,connectionLineType:C,connectionLineStyle:I,connectionLineComponent:V,connectionLineContainerStyle:F,selectionKeyCode:W,selectionOnDrag:U,selectionMode:ee,deleteKeyCode:Z,multiSelectionKeyCode:te,panActivationKeyCode:Q,zoomActivationKeyCode:K,onlyRenderVisibleElements:de,selectNodesOnDrag:q,defaultViewport:ke,translateExtent:De,minZoom:we,maxZoom:he,preventScrolling:pe,zoomOnScroll:Re,zoomOnPinch:oe,zoomOnDoubleClick:Me,panOnScroll:ce,panOnScrollSpeed:Ne,panOnScrollMode:Ce,panOnDrag:et,onPaneClick:ve,onPaneMouseEnter:gt,onPaneMouseMove:ht,onPaneMouseLeave:Xe,onPaneScroll:pt,onPaneContextMenu:Lt,onSelectionContextMenu:O,onSelectionStart:j,onSelectionEnd:B,onEdgeUpdate:ho,onEdgeContextMenu:po,onEdgeDoubleClick:yo,onEdgeMouseEnter:mo,onEdgeMouseMove:xo,onEdgeMouseLeave:So,onEdgeUpdateStart:bo,onEdgeUpdateEnd:wo,edgeUpdaterRadius:Eo,defaultMarkerColor:We,noDragClassName:Mo,noWheelClassName:vo,noPanClassName:Vt,elevateEdgesOnSelect:To,rfId:yt,disableKeyboardA11y:Ft,nodeOrigin:ge,nodeExtent:Ee}),E.jsx(tr,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:f,onConnectStart:p,onConnectEnd:g,onClickConnectStart:x,onClickConnectEnd:S,nodesDraggable:X,nodesConnectable:se,nodesFocusable:L,edgesFocusable:be,edgesUpdatable:Ye,elementsSelectable:Ze,elevateNodesOnSelect:Ro,minZoom:we,maxZoom:he,nodeExtent:Ee,onNodesChange:No,onEdgesChange:Co,snapToGrid:re,snapGrid:ue,connectionMode:y,translateExtent:De,connectOnClick:Po,defaultEdgeOptions:Do,fitView:Ao,fitViewOptions:$o,onNodesDelete:H,onEdgesDelete:A,onNodeDragStart:P,onNodeDrag:T,onNodeDragStop:D,onSelectionDrag:k,onSelectionDragStart:b,onSelectionDragStop:R,noPanClassName:Vt,nodeOrigin:ge,rfId:yt,autoPanOnConnect:Io,autoPanOnNodeDrag:zo,onError:Ho,connectionRadius:Oo,isValidConnection:Bo}),E.jsx(Js,{onSelectionChange:_}),Ae,E.jsx(Ms,{proOptions:ko,position:_o}),E.jsx(ir,{rfId:yt,disableKeyboardA11y:Ft})]})})});gi.displayName="ReactFlow";export{it as M,gi as R,E as j};
